+++
title = "📝Clojure Product Development"
tags = ["WIKI"]
draft = false
+++

up: [📂Clojure Development]({{< relref "20220211141917.md" >}}) tags: [🏷Clojure]({{< relref "20211111225741.md" >}})

Clojure開発であれどうやるんだっけというライブラリをまとめる.

-   refs:
    -   [📝Clojure Web Development]({{< relref "20220118092453.md" >}}) : Web関係はこっち
    -   [📝Clojure API Client Development]({{< relref "20220209102028.md" >}}) : Client API関係はこっち:


## Clojure命名規約 {#clojure命名規約}

[Clojureスタイルガイド](https://totakke.github.io/clojure-style-guide/) が大変参考になる. あとはGitHubで他人-のコードリーディング.

ここにはとりあえず身につけたい努力目標をメモしていく. 本当はスタイルとかは個人の努力に頼るのはアンチパターンでツールでチェックするのがいいんだけどな...そういうツールはおいおい調査.


### 関数名や変数名はlisp-case, Protocols/Records/Structs/TypesはCaptalCase {#関数名や変数名はlisp-case-protocols-records-structs-typesはcaptalcase}

ref: <https://totakke.github.io/clojure-style-guide/#lisp-case>

refs:

-   <https://totakke.github.io/clojure-style-guide/#CamelCase-for-protocols-records-structs-and-types>
-   <https://github.com/bbatsov/clojure-style-guide/blob/master/README.adoc#naming-protocols-records-structs-and-types>

なんか日本語訳のCamelCaseは原文と違うな...

CapitalCase is also known as UpperCamelCase, \`CapitalWords and PascalCase.


### private functionsには defn- で印をつける {#private-functionsには-defn-で印をつける}

ref: <https://totakke.github.io/clojure-style-guide/#private>


### 副作用の持つ関数は!, 変換をする関数の名称はtoではなく-&gt; {#副作用の持つ関数は-変換をする関数の名称はtoではなく}

e.g.) reset!


### Java Classでパフォーマンスが下がったら^でType Hintsをつける {#java-classでパフォーマンスが下がったら-でtype-hintsをつける}

reflection抑止によるコンパイル速度向上.

ref: <https://clojure.org/reference/java_interop#typehints>

どちらかというと，使うなという意味だな🤔

&gt;  Normally, one should avoid the use of type hints until there is a known performance bottleneck.

リフレクションってなに？と思ったら過去記事を書いてた...

[🖊Java のリフレクションでインスタンスやメソッドを動的生成する | Futurismo](https://futurismo.biz/archives/2715/)


### 定数に特別な表記をしない {#定数に特別な表記をしない}

JavaとかPythonで定数を大文字にする慣習は注意. Clojureでは全てが定数なので不要.

(def MAX-SIZE 10) ; Java style NG!!!


## Clojure: 状態管理 {#clojure-状態管理}

いろいろあるがナウいのはIntegrantかな？

-   [stuartsierra/component](https://github.com/stuartsierra/component)
-   [tolitius/mount](https://github.com/tolitius/mount)
-   [weavejester/integrant](https://github.com/weavejester/integrant/projects?type=beta)

状態管理ライブラリとは関数型パラダイム固有のものかな？Redux的な.後で調べたい.


### Clojure: Integrant {#clojure-integrant}

[weavejester/integrant](https://github.com/weavejester/integrant/projects?type=beta)

-   [Integrant入門(1) - Integrantの基本 - ayato-p](https://scrapbox.io/ayato-p/Integrant%E5%85%A5%E9%96%80(1)_-_Integrant%E3%81%AE%E5%9F%BA%E6%9C%AC)
-   [はじめてのDuct - Uzabase Tech](https://tech.uzabase.com/entry/2018/04/03/115236)
    -   integrantについても書かれてる.


### Clojure: Duct {#clojure-duct}

<https://github.com/duct-framework/duct>

Integrantをベースにした拡張機能を提供.
Webフレームワークではなくもっと汎用的なもの, フレームワークのフレームワーク.

-   [Ductモジュール入門](https://www.slideshare.net/KentOhashi/duct-module-getting-started)


## Clojure: Logging {#clojure-logging}

Javaの資産を使うか否かが採用のポイントかな？
Javaのロギングライブラリは歴史がある.
ログはViewerがよいとワクワクするからな.


### tools.logging {#tools-dot-logging}

<https://github.com/clojure/tools.logging>

clojure tools.logging libaryでJavaの資産を活用.

ref: [🖊Logbackのログを見やすくする方法(ファイルをgrep, Lilith) | Futurismo](https://futurismo.biz/archives/6825/)


### timbre {#timbre}

Pure Clojure/Script logging library.

<https://github.com/ptaoussanis/timbre>

[slf4j-timbre](https://github.com/fzakaria/slf4j-timbre) をつかうとJavaのロギングライブラリと連携可能.

なんかドキュメントがわかりにくいな...

日本の時刻設定例:

```clojure
(def timbre-config {:timestamp-opts {:pattern  "yyyy-MM-dd HH:mm:ss,SSS"
                                     :locale   (java.util.Locale. "ja_JP")
                                     :tiemzone (java.util.TimeZone/getTimeZone "Asia/Tokyo")}})
(timbre/merge-config! timbre-config)
```


## Clojure Archtecture {#clojure-archtecture}

-   [プログラミング言語とシステムデザイン](https://www.slideshare.net/tsutomuyano/ss-250915366)
    -   Clojureの設計指針 by t_yano.
    -   namespaceをドメインにするればいい.
        -   データを関心領域としてそこに対する操作が関数.
        -   ドメインに操作を関数定義すればいい.
-   [システムの複雑さはどこから来るのか – Out of the tar pitを読む - Uzabase Tech](https://tech.uzabase.com/entry/2021/05/20/141950)
    -   これもby t_yano.
-   ref: [📝Clojure Records]({{< relref "20220117172324.md#clojure-data-types" >}})
    -   Clojure Recordを積極的につかう.
-   [REPLライフをもっと快適に](https://www.slideshare.net/sohta/repl-40110261)
    -   Component 単位でシステムをつくるというアイデア, なるほど🤔


## Others {#others}

-   [How to Name Clojure Functions – Digital Digressions by Stuart Sierra](https://stuartsierra.com/2016/01/09/how-to-name-clojure-functions)
    -   関数名どうするか問題.
