+++
title = "📝Clojure Async"
tags = ["WIKI"]
draft = false
+++

up: [📂Clojure Core]({{< relref "20220112142936.md" >}})

Clojure core.asyncについて. 非同期プログラミングをうまく行う.

<https://github.com/clojure/core.async>

わたしの拙い記憶だと, 非同期処理をJava やPythonでうまく処理するには，同期キューを用いたproducer-consumer patternをつかうのが鉄板だが，それをcore.asyncをつかうことによってかんたんに実装できる(素晴らしい).

一応過去記事をみると，共有メモリ方式ではなく，決定性データフローモデル??(忘れた).

-   refs
    -   [🖊Java で Producer-Consumer Pattern を実装してみた | Futurismo](https://futurismo.biz/archives/2656/)
    -   [🖊データフロー変数 (Oz) で実現する Producer-Consumer Pattern | Futurismo](https://futurismo.biz/archives/2829/)


## Clojure: delay, future, promiseの違い {#clojure-delay-future-promiseの違い}

いずれも同じ関数deref, またはリーダマクロ@で読み出せるところがややこしい.

まず3つはtypeで調べるとそれぞれ型が違う.

delayは遅延評価であり, force or deref or @ をつかって評価してはじめて計算がはじまる.

一方, futureは 遅延評価ではない. 評価はバックグラウンド(i.e.別スレッド)で始まるがその結果は参照してはじめてわかる(or まだ計算が終わってないかもということもわかる)

ref: [clojure future vs delay - Stack Overflow](https://stackoverflow.com/questions/28985818/clojure-future-vs-delay)

promiseは futureの仲間だがややこしいので後で調べる.

ref :[terminology - How do Clojure futures and promises differ? - Stack Overflow](https://stackoverflow.com/questions/4623536/how-do-clojure-futures-and-promises-differ)


## Refenreces {#refenreces}

-   🔗[Clojure + core.async による非同期＆並列プロセスの世界 - 紙箱](https://boxofpapers.hatenablog.com/entry/core_async)


## Active Recalls {#active-recalls}


### clojure.coreの delayとfuture違いはなんですか？ {#clojure-dot-coreの-delayとfuture違いはなんですか}

delayは遅延評価, futureは別スレッドでのバックグラウンド評価.


### Clojure core.asyncのチャネルの宣言のためのメソッドはなんですか？ {#clojure-core-dot-asyncのチャネルの宣言のためのメソッドはなんですか}

async/chan

ex. (def tea-channel (async/chan 10))


### Clojure core.asyncのchannelに同期的に値を取り出すときのシンタックスはなんですか? {#clojure-core-dot-asyncのchannelに同期的に値を取り出すときのシンタックスはなんですか}

/&gt;!!


### Clojure core.asyncのchannelに非同期にput(or get)するときの ! の数は? {#clojure-core-dot-asyncのchannelに非同期にput--or-get--するときの-の数は}

1つ.


### Clojure core.asyncにおいて値がチャネルに入ってくるのをボーリングするためのブロックの記法はなんですか？ {#clojure-core-dot-asyncにおいて値がチャネルに入ってくるのをボーリングするためのブロックの記法はなんですか}

async/go-loop  と recur

ex.

(def tea-channel (async/chan 10))
(async/go-loop []
                   (println "hi from " (async/&lt;! tea-channel))
                   (recur))
